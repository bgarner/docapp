const API_DOMAIN="http://localhost:8000",API_VERSION="v1",BANNER_ID=1,RECENT_DOCS_DAYS=21;var app={initialize:function(){this.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,!1)},onDeviceReady:function(){app.receivedEvent("deviceready")},receivedEvent:function(a){var b=document.getElementById(a),c=b.querySelector(".listening"),d=b.querySelector(".received");c.setAttribute("style","display:none;"),d.setAttribute("style","display:block;"),console.log("Received Event: "+a)}};$(document).ready(function(){loadJSONNavigation(),initClose()}),$("#logo").click(function(){loadIndex()});var initNav=function(){$(".navitem").on("click",function(){var a=$(this).attr("id"),b=$(this).attr("data-nav"),c=$(this).attr("data-title");openPanel(a,b,c),$(".navitem").off("click")})},initSubNav=function(){$(".hasSubNav").on("click",function(){var a=$(this).attr("data-subnav");$(this).attr("data-title"),$(this).attr("data-parent");loadNavigation(a)})},initClose=function(){$("#close").click(function(){closePanel(),initNav()})},initFileOpen=function(){$(".openfile").on("click",function(){el=document.getElementById("overlay"),el.style.visibility="visible"==el.style.visibility?"hidden":"visible";$(this).attr("data-file")})},initListViewItems=function(){$(".openList").click(function(){var a=$(this).attr("data-loadList"),b=$(this).attr("data-listTitle");loadContent(b,a)})},openPanel=function(a,b,c){$("#panel").addClass("open"),$("#arrow").hide(),$(".navitem").addClass("grey"),$("#"+a).removeClass("grey"),$("#"+a).addClass("selectedItem"),$("#panel").animate({width:"+=750"},300,function(){$("#close").fadeIn(),$("#navtitle").fadeIn(),setNavTitle(c),loadNavigation(b)})},closePanel=function(){$("#navtitle").hide(),$(".navbox").hide(),$(".navitem").removeClass("grey"),$(".navitem").removeClass("selectedItem"),$("#panel").animate({width:"-=750"},300,function(){$("#main>#arrow")&&$("#arrow").show()}),$("#close").hide()},loadNavigation=function(a){$("#subTitle").html(""),$(".navbox").hide(),$("#title-divider").hide(),$("#subTitle").hide(),$("#back").hide();var b=$("#"+a).attr("data-parent"),c=$("#"+a).attr("data-subfoldertitle"),d=$("#"+a).attr("data-isTopLevel");"true"==d?($("#title-divider").hide(),$(".navbox").hide(),$("#title-divider").hide(),$("#subTitle").hide(),$("#back").hide()):($("#subTitle").html(c),$("#subTitle").fadeIn(),$("#title-divider").fadeIn(),(b||"undefined"!=typeof b)&&(setBackButton(b),$("#back").fadeIn())),$("#"+a).fadeIn()},loadContent=function(a,b){$("#main").fadeOut(10),closePanel(),$("#main").load("content/list.html",function(){loadListView(a,b)}).fadeIn(1e3),initNav()},closeModal=function(){el=document.getElementById("overlay"),el.style.visibility="visible"==el.style.visibility?"hidden":"visible"},setNavTitle=function(a){$("#topLevelTitle").html(a)},setBackButton=function(a){$("#back").unbind(),$("#back").on("click",function(){loadNavigation(a)})},loadIndex=function(){$("#navtitle").hide(),$("#close").hide(),$(".navbox").hide(),$(".navitem").removeClass("grey"),$("#back").hide(),$("#panel").removeClass("open"),$("#panel").css({width:"0"});var a=$("#panel").width();console.log("width: "+a),$("#main>#arrow")&&$("#arrow").show(),$("#main").fadeOut(10),$("#main").load("content/index-content.html").fadeIn(500),initNav()},loadJSONNavigation=function(){$.getJSON("http://localhost:8000/api/v1/banner/1/navigation",function(a){var b=0;$.each(a,function(c,d){inspectNode(d,a),b++})}).done(function(){initNav(),initSubNav(),initFileOpen(),initListViewItems()})},inspectNode=function(a,b){if(0==a.is_child){var c=a.label,d=a.id;d=c+"-"+d,d=d.replace(" ","-");var e=constructNavElement("topLevel",c,d);return appendToContainer("nav",e),void constructSubNavContainer(d,"",c)}if(1==a.is_child){var f=a.children,c=a.label,d=a.id,g=a.parent_id,h=b[g].label,i=h.replace(" ","-"),j=c.replace(" ","-"),k=i+"-"+g;if(f.length>0){var e=constructNavElement("child",c,d,h,g);appendToContainer(k,e),parentContainerId=k;var l=j+"-"+d;return constructSubNavContainer(l,parentContainerId,c),void $.each(f,function(a,c){inspectNode(c,b)})}if(0==f.length&&"undefined"==typeof a.weeks){var e=createLeaf(c,d);return void appendToContainer(k,e)}if(a.weeks){var e=constructNavElement("child",c,d,h,g);appendToContainer(k,e);var m=a.label;m=m.replace(" ","-");var n=b[a.parent_id].label;n=n.replace(" ","-"),subNavContainerWeeksId=m+"-"+a.id,constructSubNavContainer(subNavContainerWeeksId,n,m);var o=a.weeks;$.each(o,function(a,b){var c=createLeaf(b.week,b.week_id);appendToContainer(subNavContainerWeeksId,c)})}}},constructSubNavContainer=function(a,b,c){var d;d="<div id='"+a+"' data-subfoldertitle='"+c+"' data-parent='"+b+"' class='navbox'></div>",$("#panel").append(d)},appendToContainer=function(a,b){$("#"+a).append(b)},constructNavElement=function(a,b,c,d,e){var f;switch(a){case"topLevel":return f="<span class='navitem' id='toplevel-"+c+"' data-nav='"+c+"' data-title='"+b+"'>"+b+"</span>";case"child":var g=b.replace(" ","-"),h=d.replace(" ","-");return f="<div class='selectbox hasSubNav' id='' data-parent='"+h+"-"+e+"' data-subnav='"+g+"-"+c+"'>",f+="   <div class='selectbox-content'>",f+="        <img src='img/bikes-nav.jpg' />",f=f+"        <h2>"+b+"</h2>",f+="    </div>",f+="</div> "}},createLeaf=function(a,b){var c;return c="<div class='selectbox openList' data-listTitle='"+a+"' data-loadList='"+b+"'>",c+="    <div class='selectbox-content'>",c+="        <img src='img/snowsports-nav.jpg' />",c=c+"        <h2>"+a+"</h2>",c+="    </div>",c+="</div>"},loadListView=function(a,b){$(".listTitle").html(b+" "+a);var c;$.getJSON("http://localhost:8000/api/v1/folder/"+b,function(a){var b=0;$.each(a.files,function(a,d){c="<tr>",c=c+"    <td><span class='fileicons file-pdf'></span><span class='filetitle'>"+d.title+"</span></td>",c=c+"    <td>"+d.description+"</td>",c=c+"    <td>"+d.created_at+"</td>",c+="    <td></td>",c+="</tr>",$("#fileListTable").append(c),b++})}).done(function(){})},recentDocuments=function(){$.getJSON("http://localhost:8000/api/v1/banner/1/document/recent/21",function(a){var b=0;$.each(a,function(c,d){inspectNode(d,a),b++})}).done(function(){initNav(),initSubNav(),initFileOpen(),initListViewItems()})};